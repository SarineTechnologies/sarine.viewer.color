/*!
sarine.viewer.color - v0.8.4 -  Tuesday, December 19th, 2017, 9:26:35 AM 
 The source code, name, and look and feel of the software are Copyright Â© 2015 Sarine Technologies Ltd. All Rights Reserved. You may not duplicate, copy, reuse, sell or otherwise exploit any portion of the code, content or visual design elements without express written permission from Sarine Technologies Ltd. The terms and conditions of the sarine.com website (http://sarine.com/terms-and-conditions/) apply to the access and use of this software.
 */
(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=function(a){function c(a){this.preloadAssets=b(this.preloadAssets,this);var d,e,f;c.__super__.constructor.call(this,a),this.isAvailble=!0,this.colorGradeMaps={1:"D",2:"E",3:"F",4:"G",5:"H",6:"I",7:"J",8:"K",9:"L",10:"M",11:"N",12:"O-P",13:"Q-R",14:"S-T",15:"U-V",16:"W-X",17:"Y-Z"},this.keysToIndex={D:1,E:2,F:3,G:4,H:5,I:6,J:7,K:8,L:9,M:10,N:11,OP:12,QR:13,ST:14,UV:15,WX:16,YZ:17},this.resourcesPrefix=a.baseUrl+"atomic/v1/assets/",this.colorAssets=a.baseUrl+"atomic/v1/js/color-assets/clean",this.atomConfig=configuration.experiences.filter(function(a){return"colorExperience"===a.atom})[0],this.atomConfig||(this.atomConfig=configuration.experiences.filter(function(a){return"customHtml"===a.atom})[0]),this.resources=[{element:"link",src:"owl.carousel.css"},{element:"script",src:"owl.carousel.min.js"}],d=".owl-carousel .item{margin:2px;border-color: gray;cursor: pointer; border: 2px; border-radius: 3px; box-shadow: 1px 1px 2px 2px rgba(0, 0, 0, 0.2); transition: all 200ms ease-out; font: initial; }",d+=".owl-carousel .item img{  display: block;  width: 110%;  margin-left: -5%;  height: auto; }",d+=".owl-carousel  .owl-item{position:initial;}",d+=".owl-item.active.center{-webkit-transform: scale(1.3);-ms-transform: scale(1.3);transform: scale(1.3);  background: white;  z-index: 10000; position: relative;}",d+=".owl-stage {height:300px;padding-top:20px;}",d+=".owl-stage-outer {max-height:130px;    padding-top: 40px;}",e=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style"),f.type="text/css",f.styleSheet?f.styleSheet.cssText=d:f.appendChild(document.createTextNode(d)),e.appendChild(f),this.domain=window.coreDomain,this.numberOfImages=this.atomConfig&&this.atomConfig.NumberOfImages||17}return d(c,a),c.prototype.convertElement=function(){return this.element.append('<div class="owl-carousel owl-theme"></div>')},c.prototype.preloadAssets=function(a){var b,c,d,e,f,g,h,i,j;for(c=0,e=this.resources.map(function(a){return"script"===a.element}),f=function(a){if(++c===e.length-1&&void 0!==a)return setTimeout(function(b){return function(){return a()}}(),500)},i=this.resources,j=[],g=0,h=i.length;g<h;g++)d=i[g],b=document.createElement(d.element),"script"===d.element?($(document.body).append(b),b.onload=b.onreadystatechange=function(){return f(a)},b.src=this.resourcesPrefix+d.src+cacheVersion,b.type="text/javascript"):(b.href=this.resourcesPrefix+d.src+cacheVersion,b.rel="stylesheet",b.type="text/css"),j.push($(document.head).prepend(b));return j},c.prototype.first_init=function(){var a,b;return a=$.Deferred(),b=this,this.stoneColor=window.stones[0].stoneProperties.color,b.keysToIndex.hasOwnProperty(this.stoneColor)?this.preloadAssets(function(){var c;return this.pattern=b.atomConfig&&b.atomConfig.ImagePatternClean||"colorscalemaster-stacked_*.png",this.firstImageName=this.pattern.replace("*","1"),c=b.colorAssets+"/"+this.firstImageName+cacheVersion,b.loadImage(c).then(function(c){return-1===c.src.indexOf("data:image")&&-1===c.src.indexOf("no_stone")?a.resolve(b):(b.isAvailble=!1,b.element.empty(),this.div=$("<div>"),this.div.attr({style:"background-color:gray;width:150px;margin:0 auto;"}),this.canvas=$("<canvas>"),this.canvas[0].width=c.width,this.canvas[0].height=c.height,this.ctx=this.canvas[0].getContext("2d"),this.ctx.drawImage(c,0,0,c.width,c.height),this.canvas.attr({class:"no_stone"}),this.div.append(this.canvas),b.element.append(this.div),a.resolve(b))})}):(this.failed(),a.resolve(this)),a},c.prototype.failed=function(){var a,b;return b=this,a=$.Deferred(),b.loadImage(b.callbackPic).then(function(c){return b.isAvailble=!1,b.element.empty(),this.canvas=$("<canvas>"),this.canvas[0].width=c.width,this.canvas[0].height=c.height,this.ctx=this.canvas[0].getContext("2d"),this.ctx.drawImage(c,0,0,c.width,c.height),this.canvas.attr({class:"no_stone"}),b.element.append(this.canvas),a.resolve(b)})},c.prototype.full_init=function(){var a,b,c,d,e,f,g;if(a=$.Deferred(),g=this,this.stoneColor=window.stones[0].stoneProperties.color,g.keysToIndex.hasOwnProperty(this.stoneColor)){for(this.owlCarousel=this.element.find(".owl-carousel"),this.imagePath=this.colorAssets+"/",e="colorExperience"===g.atomConfig.atom?g.atomConfig.atom:g.atomConfig.id,f=$(".slide.slide--"+e).find(".slide__content--colorExperience"),f.removeClass("slide__content"),$(".slide.slide--"+e).find(".slide__content--"+e).removeClass("slide__content"),this.pattern=this.atomConfig&&this.atomConfig.ImagePatternClean||"colorscalemaster-stacked_*.png",this.filePrefix=this.pattern.replace(/\*.[^\/.]+$/,""),this.fileExt="."+this.pattern.split(".").pop(),b=1;b<=this.numberOfImages;)this.newPath=this.imagePath+this.filePrefix+b+this.fileExt,this.container=$("<div>"),this.container.attr({class:"item"}),c=$("<img>"),c.attr({src:this.newPath}),d=$("<span>").html(this.colorGradeMaps[b]),d.attr({class:"color-grade-span"}),this.container.append(d),this.container.append(c),this.owlCarousel.append(this.container),b++;this.owlCarousel.owlCarousel({center:!0,dots:!0,margin:1,onInitialized:function(a){return console.log("owl carousel initialized"),a,setTimeout(function(){var a;return this.stoneColor=window.stones[0].stoneProperties.color,a=g.keysToIndex[this.stoneColor],$(".owl-carousel").trigger("to.owl.carousel",a-1)},200)},onReady:function(){return a.resolve(this)}})}else a.resolve(this);return a},c.prototype.play=function(){},c.prototype.stop=function(){},c}(Viewer),this.SarineColor=a}).call(this);
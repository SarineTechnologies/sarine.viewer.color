/*!
sarine.viewer.color - v0.7.1 -  Thursday, December 14th, 2017, 9:32:03 AM 
 The source code, name, and look and feel of the software are Copyright Â© 2015 Sarine Technologies Ltd. All Rights Reserved. You may not duplicate, copy, reuse, sell or otherwise exploit any portion of the code, content or visual design elements without express written permission from Sarine Technologies Ltd. The terms and conditions of the sarine.com website (http://sarine.com/terms-and-conditions/) apply to the access and use of this software.
 */
(function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};b=function(){function a(b){console.log(""),this.first_init_defer=$.Deferred(),this.full_init_defer=$.Deferred(),this.src=b.src,this.element=b.element,this.autoPlay=b.autoPlay,this.callbackPic=b.callbackPic,this.id=this.element[0].id,this.element=this.convertElement(),Object.getOwnPropertyNames(a.prototype).forEach(function(a){if("Error"===this[a].name)return console.error(this.id,a,"Must be implement",this)},this),this.element.data("class",this),this.element.on("play",function(a){return $(a.target).data("class").play.apply($(a.target).data("class"),[!0])}),this.element.on("stop",function(a){return $(a.target).data("class").stop.apply($(a.target).data("class"),[!0])}),this.element.on("cancel",function(a){return $(a.target).data("class").cancel().apply($(a.target).data("class"),[!0])})}var b;return b=ResourceManager.getInstance(),function(){return console.error(this.id,"must be implement")},a.prototype.first_init=Error,a.prototype.full_init=Error,a.prototype.play=Error,a.prototype.stop=Error,a.prototype.convertElement=Error,a.prototype.cancel=function(){return b.cancel(this)},a.prototype.loadImage=function(a){return b.loadImage.apply(this,[a])},a.prototype.loadAssets=function(a,b){var c,d,e,f,g,h;if(null!==a&&a.length>0){for(e=[],g=0,h=a.length;g<h;g++)d=a[g],"script"===d.element?e.push(d.src+cacheVersion):(c=document.createElement(d.element),c.href=d.src+cacheVersion,c.rel="stylesheet",c.type="text/css",$(document.head).prepend(c));f=0,e.forEach(function(a){return $.getScript(a,function(){if(++f===e.length)return b()})})}},a.prototype.setTimeout=function(a,c){return b.setTimeout.apply(this,[this.delay,c])},a}(),this.Viewer=b,a=function(a){function b(a){this.preloadAssets=c(this.preloadAssets,this);var d,e,f;b.__super__.constructor.call(this,a),this.isAvailble=!0,this.colorGradeMaps={1:"D",2:"E",3:"F",4:"G",5:"H",6:"I",7:"J",8:"K",9:"L",10:"M",11:"N",12:"O-P",13:"Q-R",14:"S-T",15:"U-V",16:"W-X",17:"Y-Z"},this.keysToIndex={D:1,E:2,F:3,G:4,H:5,I:6,J:7,K:8,L:9,M:10,N:11,"O-P":12,"Q-R":13,"S-T":14,"U-V":15,"W-X":16,"Y-Z":17},this.resourcesPrefix=a.baseUrl+"atomic/v1/assets/",this.colorAssets=a.baseUrl+"atomic/v1/js/color-assets/clean",this.atomConfig=configuration.experiences.filter(function(a){return"colorExperience"===a.atom})[0],this.resources=[{element:"link",src:"owl.carousel.css"},{element:"script",src:"owl.carousel.min.js"}],d=".owl-carousel .item{margin:2px;border-color: gray;cursor: pointer; border: 2px; border-radius: 3px; box-shadow: 1px 1px 2px 2px rgba(0, 0, 0, 0.2); transition: all 200ms ease-out; font: initial; }",d+=".owl-carousel .item img{  display: block;  width: 110%;  margin-left: -5%;  height: auto; }",d+=".owl-carousel  .owl-item{position:initial;}",d+=".owl-item.active.center{    -webkit-transform: scale(1.3);    background: white;    z-index: 10000;    position: relative;}",d+=".owl-stage {height:300px;padding-top:20px;}",d+=".owl-stage-outer {max-height:130px;    padding-top: 40px;}",e=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style"),f.type="text/css",f.styleSheet?f.styleSheet.cssText=d:f.appendChild(document.createTextNode(d)),e.appendChild(f),this.domain=window.coreDomain,this.numberOfImages=this.atomConfig&&this.atomConfig.NumberOfImages||17}return e(b,a),b.prototype.convertElement=function(){return this.element.append('<div class="owl-carousel owl-theme"></div>')},b.prototype.preloadAssets=function(a){var b,c,d,e,f,g,h,i,j;for(c=0,e=this.resources.map(function(a){return"script"===a.element}),f=function(a){if(++c===e.length-1&&void 0!==a)return setTimeout(function(b){return function(){return a()}}(),500)},i=this.resources,j=[],g=0,h=i.length;g<h;g++)d=i[g],b=document.createElement(d.element),"script"===d.element?($(document.body).append(b),b.onload=b.onreadystatechange=function(){return f(a)},b.src=this.resourcesPrefix+d.src+cacheVersion,b.type="text/javascript"):(b.href=this.resourcesPrefix+d.src+cacheVersion,b.rel="stylesheet",b.type="text/css"),j.push($(document.head).prepend(b));return j},b.prototype.first_init=function(){var a,b;return a=$.Deferred(),b=this,this.stoneColor=window.stones[0].stoneProperties.color,b.keysToIndex.hasOwnProperty(this.stoneColor)?this.preloadAssets(function(){var c;return this.pattern=b.atomConfig&&b.atomConfig.ImagePatternClean||"colorscalemaster-stacked_*.png",this.firstImageName=this.pattern.replace("*","1"),c=b.colorAssets+"/"+this.firstImageName+cacheVersion,b.loadImage(c).then(function(c){return-1===c.src.indexOf("data:image")&&-1===c.src.indexOf("no_stone")?a.resolve(b):(b.isAvailble=!1,b.element.empty(),this.div=$("<div>"),this.div.attr({style:"background-color:gray;width:150px;margin:0 auto;"}),this.canvas=$("<canvas>"),this.canvas[0].width=c.width,this.canvas[0].height=c.height,this.ctx=this.canvas[0].getContext("2d"),this.ctx.drawImage(c,0,0,c.width,c.height),this.canvas.attr({class:"no_stone"}),this.div.append(this.canvas),b.element.append(this.div),a.resolve(b))})}):(this.failed(),a.resolve(this)),a},b.prototype.failed=function(){var a,b;return b=this,a=$.Deferred(),b.loadImage(b.callbackPic).then(function(c){return b.isAvailble=!1,b.element.empty(),this.canvas=$("<canvas>"),this.canvas[0].width=c.width,this.canvas[0].height=c.height,this.ctx=this.canvas[0].getContext("2d"),this.ctx.drawImage(c,0,0,c.width,c.height),this.canvas.attr({class:"no_stone"}),b.element.append(this.canvas),a.resolve(b)})},b.prototype.full_init=function(){var a,b,c,d,e;if(a=$.Deferred(),e=this,this.stoneColor=window.stones[0].stoneProperties.color,e.keysToIndex.hasOwnProperty(this.stoneColor)){for(this.owlCarousel=this.element.find(".owl-carousel"),this.imagePath=this.colorAssets+"/",$(this.element).parent().parent().parent().parent().hasClass("slide__content--colorExperience")?$(this.element).parent().parent().parent().parent().css("padding:0!important"):$(this.element).parent().parent().parent().parent().parent().parent().css("padding:0!important"),this.pattern=this.atomConfig&&this.atomConfig.ImagePatternClean||"colorscalemaster-stacked_*.png",this.filePrefix=this.pattern.replace(/\*.[^\/.]+$/,""),this.fileExt="."+this.pattern.split(".").pop(),b=1;b<=this.numberOfImages;)this.newPath=this.imagePath+this.filePrefix+b+this.fileExt,this.container=$("<div>"),this.container.attr({class:"item"}),c=$("<img>"),c.attr({src:this.newPath}),d=$("<span>").html(this.colorGradeMaps[b]),d.attr({class:"color-grade-span"}),this.container.append(d),this.container.append(c),this.owlCarousel.append(this.container),b++;this.owlCarousel.owlCarousel({center:!0,dots:!0,margin:1,onInitialized:function(a){return console.log("owl carousel initialized"),a,setTimeout(function(){var a;return this.stoneColor=window.stones[0].stoneProperties.color,a=e.keysToIndex[this.stoneColor],$(".owl-carousel").trigger("to.owl.carousel",a-1)},200)},afterMove:function(){return $("owl-item").css({transform:"none"}),$("active").eq(1).css({transform:"scale(1.9)",zIndex:3e3})},onReady:function(){return a.resolve(this)}})}else a.resolve(this);return a},b.prototype.play=function(){},b.prototype.stop=function(){},b}(b),this.SarineColor=a}).call(this);